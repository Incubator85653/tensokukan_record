東方非想天則 対戦記録自動集計プログラム「天則観」

◆概要
　ネットワーク対戦の対戦結果を記録します。そのはずです。
　動作がおかしかったり、みょんなエラーが出るかもしれませんが、
　これは永遠の【アルファ版】です。悪しからずご了承願います。

◆通知アイコンのコンテキストメニュー(通知アイコンを右クリック)
　●対戦表を表示する
　　対戦表を表示します

　●プロフ短縮キー設定
　　プロフィールを切り替える為のショートカットキー設定ダイアログを表示します。
　　ちなみに対戦表以外のダイアログはプロフィール変更しても更新されません。
　　これはコスト的な問題によるものです。

　●自動カウントしない
　　自動集計が止まります

　●連戦リミッタ
　　４連戦以上はノーコンテストです。自動カウントしないとは別にブロックします。
　　起動時はステート憶えっぱなしなので、起動しっぱなしの場合、時間を置いた
　　連戦もリミッタに引っ掛かります。あと、相手のIPアドレスを見ているので、違う
　　プロファイルでもIPが同一だと誤爆します。

　●表示モード
　　戦績の表示方法を変更することが出来ます。
　　データが飛んでも知りません。
　　□標準モード
　　　Rev.7までの表示方法を使います。
　　□HKSモード
　　　昔見たことがあるような表示方法を使います。
　　
　●対戦結果コピー
　　自動記録時に対戦結果をクリップボードにコピーします。
　　何も記録しない・相手プロファイル名のみ・全部（タイムスタンプ以外）
　　を選択することが出来ます。

　●自動起動
　　本ツールの起動と当時に東方非想天則を起動、東方非想天則の終了と同時に本
　　ツールのシャットダウンや戦績報告ツールを起動することが出来ます。本機能を
　　利用するには、設定をオンにするだけではなく、項目のパス設定を行う必要が
　　あります。
　　設定しなかった場合はファイラーが起動します。

  ●表示オプション
  　ちょっとした表示の装飾機能が収められています。
　　設定が反映されるのは更新がかかってからか、ウィンドウを表示しなおしたとき
　　です（手抜き）
　　□勝率を下一桁まで表示
　　　勝率を小数点以下一桁まで表示します。
　　□勝敗を色分け表示
　　　勝率によって項目の色分けを行います。

　●終了する
　　終了します

◆標準モード/対戦表のシステムメニュー(対戦表のタイトルバーを右クリック)
　●自分別戦績
　　自分側から見た戦績を表示します

　●相手別戦績
　　相手側から見た戦績を表示します

　●全ての対戦
　　全ての対戦の戦績を表示します。

　●今日の対戦
　　今日の対戦の戦績を表示します

　●昨日の対戦
　　昨日の対戦の戦績を表示します

　●カスタム対戦
　　特定条件の対戦の戦績を表示します
　　相手のプロファイル名、日付の始点、終点で絞り込むことが出来ます。

　●元に戻す
　　変更分を(手動自動に関わらず)いっこ戻します
　　メモリの許す限り戻せます

　●やり直し
　　変更分を(手動自動に関わらず)いっこやり直します
　　メモリの許す限りやり直せます

　●相手プロファイル表
　　相手プロファイル表を表示します。

　●クリップボードに送る
　　現在表示されている戦績をクリップボードに送ります

◆標準モード/詳細のシステムメニュー(詳細のタイトルバーを右クリック)
　●最新の情報に更新
　　最新の情報に更新します

　●元に戻す
　　手動変更分をいっこ戻します

　●やり直し
　　手動変更分をいっこやり直します

　●クリップボードに送る
　　現在表示されている戦績をクリップボードに送ります

◆標準モード/手動変更
　詳細の勝敗セルをダブルクリックすると、勝敗を手動で追加できます。
　右ダブルクリックで、（フィルタ上で）最後に記録した対戦を削除出来ます。
　
◆標準モード/詳細
　対戦表のキャラクタをダブルクリックすると、そのキャラクタの詳しい戦績を見る
　ことが出来ます。
　　
◆HKSモード/対戦表のシステムメニュー(対戦表のタイトルバーを右クリック)
　●プロファイル
　　プロファイルを読み込みます。初回起動時はDefault.dbが読み込まれます。
　　存在しないファイルを指定すると、新しいプロファイルが作成されます。
　　選択プロファイルは次回起動時に自動的に読み込まれます。

　●元に戻す
　　手動変更分をいっこ戻します
　　メモリの許す限り戻せます

　●やり直し
　　手動変更分をいっこやり直します
　　メモリの許す限りやり直せます

　●自分別戦績
　　自分側から見た戦績を表示します

　●相手別戦績
　　相手側から見た戦績を表示します

　●全ての対戦
　　全ての対戦の戦績を表示します。

　●過去３０回の対戦
　　過去３０回の対戦の戦績を表示します

　●過去５０回の対戦
　　過去５０回の対戦の戦績を表示します

　●過去１００回の対戦
　　過去１００回の対戦の戦績を表示します

　●全ての対戦
　　全ての対戦の戦績を表示します。

　●今日の対戦
　　今日の対戦の戦績を表示します

　●昨日の対戦
　　昨日の対戦の戦績を表示します

　●カスタム対戦
　　特定条件の対戦の戦績を表示します
　　相手のプロファイル名、日付の始点、終点で絞り込むことが出来ます。

◆HKSモード/手動変更
　勝敗の数字ボックスを左ダブルクリックすると、勝敗を手動で追加できます。
　右ダブルクリックすると逆に減ります。使わない方が身のためです。

◆HKSモード/ちょっとした機能
　対戦表の名前部分を左ダブルクリックすると、その部分の対戦記録表が表示されます。
　右ダブルクリックすると、その部分の相手プロファイル表が表示されます。

◆相手プロファイル表
　戦績にある相手プロファイルをリスト形式で表示します。各対戦表ダイアログから
　飛んで来ることが出来ます。名無しは手動追加です。
　ダブルクリックすると、相手プロファイル名で絞った対戦履歴表が表示されます。

◆対戦履歴表
　過去の対戦履歴を個別にリスト形式で表示します。各対戦表ダイアログから飛んで
　来ることが出来ます。名無しは手動追加・削除です。

◆ワイルドカードを使う
　カスタム対戦・対戦履歴表のフィルタ設定で、「ワイルドカードを使う」チェック
　ボックスをオンにすることにより、プロファイル名指定にワイルドカードを使うこと
　が出来ます。任意の文字列を%（半角パーセント記号）、任意の一文字を_（半角
　アンダースコア）で表します。これらを文字として認識させたい場合は、それらの
　前に\（半角円記号・半角バックスラッシュ）を付けて下さい。

◆SWRSAddr.ini
　非想天則から情報を読み取るために必要な情報を定義するファイルです。
　バージョンが変わったときに、このファイルを編集することによって、新しい
　バージョンに対応することが出来るらしいです？

◆QnA
・緋行跡とプロファイルの互換性はありますか。
　ありません。

・UIが見難いです。何とかしてください。
　新しいUIデザインを提案してくれるとうれしいです。
　ついでに実装してくれるともっとうれしいです。

・記録漏れするんですけど。
　記録の仕組み上の制限ですが、再現性不明のため対処できません。

・どこそこがおかしいです。
・あれこれがほしいです。
　私が見えるところで報告してくれるとうれしいです。
　ついでに修正・実装してくれるともっとうれしいです。

・更新が等閑
　<del>もう作者が使ってません。</del>
  数年も経っていてろくに設計もしてないコードの世話なんて出来ません。
 
◆謝辞
　・ツールの名称をご提案くださった方々
　・永江食品愛好会の会員、その他近しい方々
　・アイコンを作ってくださった非想天則関連ツールスレッド>>92 様
　・天則観 mod を作成してくださった asm 様
　・天則観 LIKE検索diff を作成してくださった ぽい 様
　・天則観 autorun を作成してくださった autorun 様
　・ほかバグ報告・ご意見・ご要望をくださった方々
　にこの場を借りてお礼申し上げます。

◆ライセンス
　License.txt をご参照ください。

◆軌跡
20140713 Rev.14
「相手プロファイル表」にフィルタを適用するようにした
詳細ウィンドウから「相手プロファイル表」と「過去対戦履歴表」を呼び出せるようにした
対戦表の過去50戦勝率にフィルタが掛からない不具合を修正
プロフィールフィルタを設定すると詳細ウィンドウのキャプション表示がおかしくなる不具合を修正
データベースエンジンを SQLite 3.8.5 に更新

20120705 Rev.13
標準モードの自分別・相手別戦績切り換えを実装しました。集計処理に手を入れたので結構危ないです。
最近のSTLSoftでもビルドできるようになりました。(何故かisalphaをインライン展開してくれない

20111001 Rev.12
対戦フィルタの2Pキャラ部分バグを修正しました。
カスタム対戦フィルタの設定項目を整理しました。
1.10aに対応しました。

20101113 Rev.11
対戦フィルタのキャラ部分バグを修正しました。
標準モードのソートバグを修正しました。
ウィンドウサイズの自動調整機能が付きました。
データベースのテーブル設計バグを修正しました。既存のファイルには適用されません。
データベース結合ツールtskdbmergeを添付しました。
----
tskdbmergeは何が起きても知りません。バックアップを取ってから使って下さい。

20101030 Rev.10
過去対戦フィルタのキャラ部分未実装修正しました。
Windows 7でダイアログサイズ調整しました。
ウィンドウがリサイズ可能になりました（保存されません）。
iniオプションをメニュー化しました。

20100217 Rev.9
Autorunが消えていた不具合を解消しました。

20100214 Rev.8
表示モード(HKSモード)を実装しました。
----
ご提案戴いたUI案を一部採用させていただきました。
本気のアルファ版なので、危ない橋を渡りたくない方はRev.7を利用した方が
いいと思います。

20100131 Rev.7
1.10に対応しました。
文字色を修正しました。
autorun バグを多分修正しました。
ポーリング間隔が50msになりました。
利用するsqliteがバージョンアップしました

20090913 Rev.6
Windows 2000で動作不良になる不具合を多分修正しました。
自動起動が機能しない不具合を修正しました。
戦績詳細のヘッダ表示の誤りを修正しました。
戦績詳細で付加情報を表示するようになりました。
勝率で色が変わる機能を実装しました。
勝率を小数点以下まで表示する機能を実装しました。

20090912 Rev.5
戦績表示の整列を実装しました。
個別過去30戦勝率が過去50戦に変更されました。
autorun（東方非想天則・Tenco!報告ツール連動）を取り込みました。
LIKE検索を取り込みました。
--以下技術者向け--
UNICODEビルドが出来るようになりました。
MinimalStringにUNICODE,ANSI,UTF-8相互変換機能(不完全)を実装しました。
ページサイズ(4096バイト)以上のスタックをまとめて使えるようになりました。
ソートリストビューの実装を分離しました。
ファイル名を整理しました。
----
また大幅に書き換えたので、盛大にバグっている可能性があります。

20090906 Rev.4
相手プロファイル表の整列を実装しました。
自動記録時に記録をクリップボードに転送する機能を実装しました。例によってテスト
していません。
カスタム対戦フィルタのバグを修正しました。
　（非想天則関連ツールスレッド >>622さん、詳細な情報ありがとうございました）
1.03に対応しました。

20090823 Rev.3
自動記録バグを修正しました。
りどみを修正しました。
ソースが添付されていない不具合を修正しました。

20090823 Rev.2
清く正しい戦跡増減を実装しました。
元に戻す・やり直すを自動変更分にも適用させました。
対戦プロファイル一覧から対戦履歴を絞り込み表示出来る様にしました。
総合Ｎ戦にもフィルタを適用させました。
アイコンの適用をまともにしました。
1.02に対応しました。
----
戦績ＤＢ管理モジュールや元に戻す・やり直すモジュール等を大幅に書き換えたので、
盛大にバグっている可能性があります。
作者も最近になって漸く使い始めましたので、危ないバグは多分すぐ取り除く様になる
と思います。

20090821 Rev.1
初版。
連戦リミッタのバグを多分直しました。
作って下さったアイコンを適用してみました。

20090818 Rev.0
プロトタイプ。
クローズでテストしたあとRev.1にするつもりだったのですが、
この調子だと何時までも出ないので、そのまま出します。
----

[EOF]